<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>A Goodbye Note — Love Letter</title>

  <!-- Google Fonts for handwritten effect -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Homemade+Apple&family=Great+Vibes&family=Shadows+Into+Light&family=Indie+Flower&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fff8f7;
      --accent:#b84545;
      --env-base:#f6e7e3;
      --shadow: 0 28px 80px rgba(22,16,14,0.32);
      --paper-width: min(860px, 92vw);
      --paper-height: min(1100px, 86vh);
      --flap-height: 120px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background: radial-gradient(circle at 10% 10%, #fff2f3 0%, #fff 45%), linear-gradient(180deg,#fff,#fff8f2 70%);
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      padding:28px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .stage{width:100%;max-width:1200px;display:flex;flex-direction:column;align-items:center;gap:18px}

    /* Envelope */
    .envelope-wrap{
      width: min(480px, 48vw);
      height: calc(min(340px, 38vh));
      perspective:1500px;
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;
    }

    .envelope{
      position:relative;
      width:100%;
      height:100%;
      transform-style:preserve-3d;
      transition: transform 300ms ease;
      pointer-events:auto;
    }

    .envelope:hover{transform:translateY(-10px) rotateX(8deg) rotateZ(-2deg)}
    .envelope:focus{outline:4px solid rgba(184,70,70,0.12);outline-offset:8px}

    .env-body{
      position:absolute;
      inset:0;
      border-radius:14px;
      background:linear-gradient(180deg,var(--env-base), #fff5f0);
      box-shadow: var(--shadow);
      border:1px solid rgba(0,0,0,0.08);
      overflow:hidden;
      z-index:1;
      clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%);
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-blend-mode: overlay;
    }

    .env-flap{
      position:absolute;
      left:50%;
      top:0;
      transform:translateX(-50%);
      width:0;
      height:0;
      border-left: calc(50% - 12px) solid transparent;
      border-right: calc(50% - 12px) solid transparent;
      border-bottom: var(--flap-height) solid #f2d8d0;
      transform-origin: top center;
      z-index:4;
      transition: transform 900ms cubic-bezier(.2,.9,.3,1);
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
    }
    .envelope.open .env-flap{ transform: translateX(-50%) rotateX(-192deg); }

    .env-label{
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      font-family:'Homemade Apple','Shadows Into Light','Indie Flower','Great Vibes',cursive;
      color:#5b2b2b;
      font-size:clamp(24px,3.5vw,36px);
      letter-spacing:1.2px;
      text-transform:uppercase;
      text-shadow: 0 2px 4px rgba(0,0,0,0.06);
      z-index:5;
      pointer-events:none;
    }

    /* Paper */
    .paper{
      position:fixed;
      left:50%;
      top:50%;
      transform:translate(-50%,-30%) scale(0.88);
      width:var(--paper-width);
      height:var(--paper-height);
      background: #fffefc url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-size:cover;
      box-shadow: 0 40px 120px rgba(16,10,8,0.32);
      border-radius:10px;
      padding:56px 64px;
      opacity:0;
      visibility:hidden;
      transition: transform 900ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease, visibility 0ms linear 420ms;
      overflow:auto;
      z-index:20;
      border:1px solid rgba(0,0,0,0.06);
    }
    .paper::before{
      content:'';
      position:absolute;
      inset:0;
      background:repeating-linear-gradient(to bottom, transparent 0px, transparent 28px, rgba(255,150,150,0.15) 29px);
      pointer-events:none;
      border-radius:10px;
    }
    .paper.show{opacity:1;visibility:visible;transform:translate(-50%,-50%) scale(1);transition-delay:120ms}

    .paper .title{font-family:'Great Vibes','Homemade Apple','Shadows Into Light',cursive;font-size:clamp(44px,5vw,70px);color:var(--accent);margin:0 0 20px;text-align:center}
    .paper .body{font-family:'Homemade Apple','Shadows Into Light','Indie Flower','Great Vibes', 'Segoe Script', 'Bradley Hand', 'Lucida Handwriting', cursive;font-size:clamp(18px,2.2vw,24px);line-height:1.9;color:#3c2e2e;white-space:pre-wrap;letter-spacing:0.2px;text-shadow:0.4px 0.8px rgba(0,0,0,0.02);}

    .handwritten-fallback .paper .body{font-family:'Segoe Script','Bradley Hand','Lucida Handwriting',cursive;font-size:clamp(19px,2.4vw,26px);letter-spacing:0.4px;transform:skewX(-0.6deg);text-shadow:0.6px 1px rgba(0,0,0,0.03)}

    .controls{display:flex;gap:12px;justify-content:center;margin-top:20px}
    .btn{padding:8px 12px;border-radius:8px;border:1px solid rgba(0,0,0,0.1);cursor:pointer}
    .btn--accent{padding:8px 12px;border-radius:8px;border:none;background:var(--accent);color:#fff}

    @media (prefers-reduced-motion:reduce){*{transition:none!important;animation:none!important}.paper{transform:translate(-50%,-50%) scale(1);opacity:1;visibility:visible}.env-flap{transform:none}}
    @media(max-width:720px){.paper{padding:28px 20px;height:78vh;width:94vw}}
  </style>
</head>
<body>

  <main class="stage">
    <div class="envelope-wrap" id="envelopeWrap">
      <div class="envelope" id="envelope" role="button" tabindex="0" aria-pressed="false" aria-label="Open the envelope">
        <div class="env-body" aria-hidden="true"></div>
        <div class="env-flap" aria-hidden="true"></div>
        <div class="env-label">A GOODBYE NOTE!</div>
      </div>
    </div>

    <article class="paper" id="paper" aria-hidden="true">
      <h1 class="title">To the one I couldn't keep...</h1>
      <div class="body" id="noteBody">Dear —

This is placeholder text. Replace this with your real words.

Always,
Your name</div>

      <div class="controls">
        <button class="btn" id="closeBtn">Close</button>
        <button class="btn btn--accent" id="replayBtn">Replay</button>
      </div>
    </article>
  </main>

  <script>
    const wantedFonts = ['Homemade Apple','Great Vibes','Shadows Into Light','Indie Flower'];
    function checkFontsAndWarn(){
      if(!document.fonts) return;
      const missing = wantedFonts.filter(f => !document.fonts.check(`1rem "${f}"`));
      if(missing.length){
        const b = document.createElement('div');
        b.id = 'fontWarn';
        b.innerHTML = `<strong>Note:</strong> Handwriting webfonts failed to load (${missing.join(', ')}). Using local handwritten fallback.`;
        document.body.prepend(b);
        document.documentElement.classList.add('handwritten-fallback');
        setTimeout(()=> b.style.opacity = '0', 5600);
        setTimeout(()=> b.remove(), 6400);
      }
    }
    window.addEventListener('load', ()=> setTimeout(checkFontsAndWarn, 220));

    const envelope = document.getElementById('envelope');
    const paper = document.getElementById('paper');
    const closeBtn = document.getElementById('closeBtn');
    const replayBtn = document.getElementById('replayBtn');

    function openEnvelope(){
      envelope.classList.add('open');
      envelope.setAttribute('aria-pressed','true');
      paper.classList.add('show');
      paper.setAttribute('aria-hidden','false');
    }

    function closeEnvelope(){
      envelope.classList.remove('open');
      envelope.setAttribute('aria-pressed','false');
      paper.classList.remove('show');
      paper.setAttribute('aria-hidden','true');
    }

    envelope.addEventListener('click', ()=>{
      if(envelope.classList.contains('open')){
        closeEnvelope();
      } else {
        openEnvelope();
      }
    });

    envelope.addEventListener('keydown',(e)=>{
      if(e.key==='Enter' || e.key===' '){
        e.preventDefault();
        envelope.click();
      }
    });

    closeBtn.addEventListener('click',(e)=>{ e.stopPropagation(); closeEnvelope(); });
    replayBtn.addEventListener('click',(e)=>{ e.stopPropagation(); closeEnvelope(); setTimeout(()=> openEnvelope(), 240); });
    paper.addEventListener('click', e => e.stopPropagation());
  </script>
</body>
</html>
